<Directory "/srv/www/esetupd">
 
        Options FollowSymLinks
        AllowOverride All
        RewriteEngine on

# 1. ОБРАБОТКА UPDATE.VER
        # EP9
        RewriteCond %{HTTP_USER_AGENT} ^.*(EES|EEA|EFSW|ESFW)\ Update.*BPC\ 9
        RewriteRule ^(eset_upd/)?dll/update.ver$ /eset_upd/ep9/dll/update.ver [END]

        # EP10-12
        RewriteCond %{HTTP_USER_AGENT} ^.*(EES|EEA|EFSW|ESFW)\ Update.*BPC\ 1[0-2]
        RewriteRule ^ep1([0-2])/update\.ver$ /eset_upd/ep1$1/dll/update.ver [END]

        RewriteCond %{HTTP_USER_AGENT} ^.*Update.*BPC\ [3-8]
        RewriteRule ^(eset_upd/|v[3-8]/)?update\.ver$ /eset_upd/v3/dll/update.ver [END]

        RewriteCond %{HTTP_USER_AGENT} ^.*(EES|EEA)\ Update.*BPC
        RewriteRule ^(eset_upd/)?update\.ver$ - [F]

    # 2. ОБРАБОТКА ФАЙЛОВ ОБНОВЛЕНИЙ
        # EP9
        RewriteCond %{HTTP_USER_AGENT} ^.*(EES|EEA|EFSW|ESFW)\ Update.*BPC\ 9
        RewriteRule ^ep9-rel-sta/(.*)$ data/ep9/ep9-rel-sta/$1 [END]

        # EP10
        RewriteCond %{HTTP_USER_AGENT} ^.*(EES|EEA|EFSW|ESFW)\ Update.*BPC\ 10
        RewriteRule ^businesslatest-rel-sta/(.*)$ data/ep10/businesslatest-rel-sta/$1 [END]

        # V3-V8
        RewriteCond %{HTTP_USER_AGENT} ^.*Update.*BPC\ [3-8]
        RewriteRule ^v3-rel-sta/(.*)$ data/v3/v3-rel-sta/$1 [END]

########### ЗАЩИТА ОТ ОШИБОК ###########
        RewriteCond %{REQUEST_FILENAME} -f [OR]
        RewriteCond %{REQUEST_FILENAME} -d
        RewriteRule ^ - [L]

        AuthName "Please Log In"
        AuthType Basic
        AuthBasicProvider file
        AuthUserFile /srv/www/esetupd/.htpasswd
        Require valid-user
        Require ip 192.168.0.0/16
</Directory>
